// 第三方
import gulp from 'gulp';
import size from 'gulp-size';
import rev from 'swg-gulp-rev';

// 自定义
import util from '../util.js';
import config from '../config.js';

/************************************ 编译img ************************************/
gulp.task('task_img', () => {
  console.log(`>>>>>>>>>>>>>>> 图片文件开始编译。${util.getNow()}`);

  return gulp.src(config.path.img)

    // 显示img文件体积
    .pipe(size({showFiles: true}))

    // 收集img文件的MD5值
    .pipe(rev())

    // 输出img文件
    .pipe(gulp.dest(config.path.static))

    // 输出css文件与MD5值匹配关系的文件
    .pipe(rev.manifest('rev-md5/img.json'))
    .pipe(gulp.dest(config.path.temp))
});
